var t={946:t=>{t.exports=class{constructor(t,e,n,i){this.conditionalExpression=t,this.dataExpression=e,this.handlingExpression=n||"defaultTemplate",this.tripartite=i}}},600:t=>{t.exports=function(t,e){if(!t)return e;if(!e)return e;if(0!=e.indexOf("../")&&0!=e.indexOf("./"))return e;for(var n=t.split("/"),i=e.split("/");n.length&&!n[0];)n.shift();for(;i.length&&!i[0];)i.shift();if(0==e.indexOf("../")){for(;i.length&&".."==i[0];)n.pop(),i.shift();for(n.pop();i.length;)n.push(i.shift());return n.join("/")}if(0==e.indexOf("./")){for(i.shift(),n.pop();i.length;)n.push(i.shift());return n.join("/")}return e}},514:(t,e,n)=>{const i=n(864);let s=new Function("additionalContexts","with ({\n\t\t'$globals': additionalContexts.globalData\n\t}) {\n\t\twith (additionalContexts.dataFunctions) {\n\t\t\twith (additionalContexts.context) {\n\t\t\t\ttry {\n\t\t\t\t\treturn eval(additionalContexts.expression);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}");function a(t,e,n,i){return n=n||{},i=i||{},s.call(this,{globalData:i,dataFunctions:n,context:t,expression:e})}t.exports=function(t,e,n,s){if(!e)return null;if("string"==typeof e&&(e=e.trim()),"$this"===e||"this"===e)return t;if("object"==typeof t&&e in t)return t[e];if('""'===e||"''"===e)return"";let r=i(t,e);return null==r&&(r=i({$globals:s},e)),null==r&&(r=a.call(t,t,e,n,s)),r}},909:(t,e,n)=>{let i=n(946);var s=n(600);let a=n(514);t.exports=class{constructor(t,e,n={},i="",s={}){this.tripartite=t,this.template=e,this.destination=i,this.initialData=n,this.currentData=[],this.dataFunctions=s,this.continueOnTripartiteError=!0,this.callCount=0,this.callDepthLimit=1e3}run(t){let e;return t&&(e=()=>{t(null,this.destination)}),this._run(this.template,this.initialData,e),this.destination}_resolveHandlingExpression(t,e,n){return e||(e=defaultTemplateName),"$"==e.charAt(0)&&(e=a(n,e.substring(1),this.dataFunctions,this.initialData)),0!=e.indexOf("./")&&0!=e.indexOf("../")||(e=s(t.templateMeta.name,e)),e}_run(t,e,n){let s=[...t.parts].reverse();const r=()=>{if(this.callCount++,this.callCount++>this.callDepthLimit)setTimeout((()=>{this.callCount=0,r()}));else if(s.length>0){let l=s.pop();if("string"==typeof l)this.output(l),r();else if(l instanceof i){let i,s=l.conditionalExpression||l.dataExpression,o=!1;if(null==s||null==s||""===s?o=!0:l.conditionalExpression?a(e,l.conditionalExpression,this.dataFunctions,this.initialData)&&(o=!0):(i=a(e,l.dataExpression,this.dataFunctions,this.initialData),null==i?o=!1:("number"==typeof i||Array.isArray(i)&&i.length>0||i)&&(o=!0)),o){l.dataExpression&&void 0===i&&(i=a(e,l.dataExpression,this.dataFunctions,this.initialData)),null==i&&(i=e);let s,o=this._resolveHandlingExpression(t,l.handlingExpression,e),p=(Array.isArray(i)?[...i]:[i]).reverse();const u=()=>{if(p.length>0){let t=p.pop();this._run(s,t,(()=>{u()}))}else r()};o in this.tripartite.templates?(s=this.tripartite.getTemplate(o),s?u():this.continueOnTripartiteError&&r()):this.tripartite.loadTemplate(o,(t=>{if(t)s=t,u();else{let t="Could not load template: "+o;if(console.error(t),this.continueOnTripartiteError)r();else{let e=new Error(t);if(!n)throw e;n(e)}}}))}else r()}else"function"==typeof l&&(l.write?l.write(e,this.destination,(()=>{r()})):(this.output(l(e)),r()))}else n&&n()};r()}output(t){null!=t&&("string"==typeof this.destination?this.destination+=t:this.destination.write&&this.destination.write(t))}}},864:t=>{t.exports=function(t,e){if(null==t)return t;let n;for("string"==typeof e?n=e.trim().split("."):Array.isArray(e)&&(n=e);n.length>0;){let e,i=n.shift();if(i.indexOf(" ")>-1)return null;if("this"===i||"$this"===i?e=t:"object"==typeof t&&i in t&&(e=t[i]),0==n.length)return e;t=e}}},393:(t,e,n)=>{function i(t){return null!==t&&"object"==typeof t&&"function"==typeof t.pipe}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});let s=n(909),a=n(946);class r{constructor(t={}){this.templates={defaultTemplate:this._makeTemplate((function(t){return""+t}))};let{constants:e={templateBoundary:"__",templateNameBoundary:"##"}}=t;this.constants=e,this.secondaryTemplateFunctionObject=t.secondaryTemplateFunctionObject,this.loaders=t.loaders||[],this.dataFunctions=t.dataFunction||{}}_makeTemplate(t){if((e=t)&&"function"==typeof e&&e.write&&e.parts&&e.templateMeta)return t;var e;let n=this,a=function(t){let e=null,n=null,s=null;for(let t=1;t<arguments.length;t++){let a=arguments[t];i(a)?e=a:"function"==typeof a?s=a:"object"==typeof a&&(n=a)}return a.write(t,e,s,n)};return a.write=function(e,i,r,l={}){if(t&&t.write)return t.write.apply(t,arguments);{let t=new s(n,a,e,i||"",n.dataFunctions);return l&&"continueOnTripartiteError"in l&&(t.continueOnTripartiteError=l.continueOnTripartiteError),t.run(r)}},a.parts=[],t&&"function"==typeof t&&a.parts.push(t),a.templateMeta={},a}addTemplate(t,e){return"string"==typeof e?e=this.parseTemplate(e):"function"==typeof e&&(e=this._makeTemplate(e)),this.templates[t]=e,e.templateMeta=e.templateMeta||{},e.templateMeta.name=t,e}createBlank(){return new r}getTemplate(t){return this.templates[t]}loadTemplate(t,e){if(t in this.templates)e(this.templates[t]);else{let n=this,i=this.loaders.length,s=!1;0==i?(n.templates[t]=null,e(n.getTemplate(t))):this.loaders.forEach((a=>{s||a(t,(a=>{s||(i--,a?(s=!0,n.addTemplate(t,a)):0==i&&(s=!0,n.templates[t]=null),s&&e(n.getTemplate(t)))}))}))}}parseTemplateScript(t){for(var e=this.tokenizeTemplateScript(t),n=null,i=0;i<e.length;i++){var s=e[i];if(s.active)n=s.content;else if(n){var a=this.addTemplate(n,this.stripTemplateWhitespace(s.content));this.secondaryTemplateFunctionObject&&(this.secondaryTemplateFunctionObject[n]=a),n=null}}}stripTemplateWhitespace(t){var e=t.indexOf("\n");return e>-1&&""==t.substring(0,e).trim()&&(t=t.substring(e+1)),(e=t.lastIndexOf("\n"))>-1&&""==t.substring(e).trim()&&(t=t.substring(0,e)),t}_createActiveElement(t,e,n,i,s){let r=new a(t,e,n,i);return r.templateMeta=s,r}pt(t){return this.parseTemplate(t)}parseTemplate(t){var e=this.tokenizeTemplate(t);let n=this._makeTemplate();var i=n.templateMeta;for(let t of e)t.active?n.parts.push(this.tokenizeActivePart(t.content,i)):t.content&&n.parts.push(t.content);return n}tokenizeActivePart(t,e){var n=null,i=null,s=null,a=t.indexOf("??");a>-1?(n=t.substring(0,a),a+=2):a=0;var r=t.indexOf("::");return r>-1?(i=t.substring(a,r),s=t.substring(r+2)):i=t.substring(a),this._createActiveElement(n,i,s,this,e)}tokenizeTemplate(t){return this.tokenizeActiveAndInactiveBlocks(t,this.constants.templateBoundary)}tokenizeTemplateScript(t){return this.tokenizeActiveAndInactiveBlocks(t,this.constants.templateNameBoundary)}tokenizeActiveAndInactiveBlocks(t,e){let n=t.length,i=0,s=!1,a=[];for(;i<n;){let l=t.indexOf(e,i);-1==l&&(l=n);var r={active:s,content:t.substring(i,l)};a.push(r),i=l+e.length,s=!s}return a}}var l=new r;"undefined"!=typeof window&&(l.secondaryTemplateFunctionObject=window),t.exports=l,void 0!==n.g&&(n.g.Tripartite||(n.g.Tripartite=r),n.g.tripartite||(n.g.tripartite=l))},671:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("controls",'<div class="player-controls lib-player">\n\n\t<div class="library">\n\t\t<div class="kalpa-tree">\n\t\t</div>\n\n\t\t\x3c!-- <div class="drop-zone">\n\t\t\tdrop files here\t\n\t\t</div> --\x3e\n\n\n\t</div>\n\t<div class="playside">\n\t\t<div class="playlist-wrapper">\n\t\t\t<div class="playlist webhandle-drag-sortable-list">\n\t\t\t</div>\n\t\t\t<div class="playlist-bottom-buttons actions">\n\t\t\t\t<div class="left">\n\t\t\t\t\t<button class="previous" title="previous track">\n\t\t\t\t\t\t__::previous-button__\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="right">\n\t\t\t\t\t<button class="next" title="next track">\n\t\t\t\t\t\t__::next-button__\n\t\t\t\t\t</button>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="track-controls">\n\t\t\t<div class="track-title">\n\t\t\t</div>\n\t\t\t<div class="position">\n\t\t\t\t<div class="play-pause actions">\n\t\t\t\t\t<button class="play" title="play / pause">\n\t\t\t\t\t\t__::play-pause-button__\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<label>\n\t\t\t\t\t<input type="range" name="position" min="0" max="1000" value="0" />\n\t\t\t\t</label>\n\t\t\t\t<div class="position-text">\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="global-controls">\n\t\t\t\t<div class="volume">\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input type="range" name="volume" min="0" max="100" value="100" />\n\t\t\t\t\t\tVolume\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n</div>')},945:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("next-button",'<svg class="next-button-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M660-240v-480h80v480h-80Zm-440 0v-480l360 240-360 240Zm80-240Zm0 90 136-90-136-90v180Z"/></svg>')},61:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("play-pause-button",'\n<svg class="play-pause-button-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M200-312v-336l240 168-240 168Zm320-8v-320h80v320h-80Zm160 0v-320h80v320h-80Z"/></svg>')},197:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("previous-button",'<svg class="previous-button-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M220-240v-480h80v480h-80Zm520 0L380-480l360-240v480Zm-80-240Zm0 90v-180l-136 90 136 90Z"/></svg>')},652:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("test1","This is test1.tri\n")},623:(t,e,n)=>{var i=n(393);t.exports=i.addTemplate("test2","This is test2.tri\n__::./test1__\n")}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i={};(()=>{n.d(i,{A:()=>a,d:()=>r});var t=n(393),e=(n(652),n(623));n(671),n(61),n(945),n(197);let s=e;function a(){console.log(s());let e=document.createElement("div");e.innerHTML=t.getTemplate("test1")({key1:"value",key2:"value"}),document.body.append(e)}function r(){console.log("stop")}})();var s=i.A,a=i.d;export{s as default,a as stop};
//# sourceMappingURL=index.js.map